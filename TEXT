from ayx import Alteryx
import win32com.client as win32

# Read data from input
df = Alteryx.read("#1")

# Initialize Outlook
outlook = win32.Dispatch('outlook.application')

# Loop through each record
for index, row in df.iterrows():
    mail = outlook.CreateItem(0)
    mail.To = row['TO']
    mail.Subject = row['Subject']
    mail.HTMLBody = row['MailBody']
    
    mail.Send()
    print(f"Email sent to: {row['TO']}")
