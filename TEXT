फ़ाइल की सामग्री यहाँ दर्ज करें। from ayx import Alteryx
import win32com.client as win32
import os

# Read data from Alteryx input
df = Alteryx.read("#1")

# Initialize Outlook
outlook = win32.Dispatch('outlook.application')

# Loop through each row
for index, row in df.iterrows():
    mail = outlook.CreateItem(0)
    mail.To = row['TO']
    mail.Subject = row['Subject']
    mail.HTMLBody = row['MailBody']
    
    # Safely handle attachment
    attachment_path = row.get('AttachmentPath')
    if isinstance(attachment_path, str) and attachment_path.strip() and os.path.isfile(attachment_path.strip()):
        mail.Attachments.Add(attachment_path.strip())
        print(f"Attached: {attachment_path}")
    else:
        print(f"No valid attachment for row {index}")
    
    mail.Send()
    print(f"Email sent to: {row['TO']}")
